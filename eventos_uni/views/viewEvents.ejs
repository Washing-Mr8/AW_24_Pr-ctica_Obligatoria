<!DOCTYPE html>
<html lang="en">
<head>
  <%- include("head")%>
</head>
<body class="default" data-bs-theme="dark">
  <%- include("navbar") %>
  <div class="container mt-5">
    <h1 class="text-center mb-4">Lista de Eventos</h1>

    <% if (events && events.length > 0) { %>
      <div class="list-group">
        <% events.forEach(event => { %>
          <div class="list-group-item mb-3">
            <h4 class="mb-1"><%= event.Titulo %></h4>
            <p class="mb-2"><strong>Descripción:</strong> <%= event.Descripcion %></p>
            <p class="mb-2"><strong>Fecha:</strong> <%= event.Fecha %> <strong>Hora:</strong> <%= event.Hora %></p>
            <p class="mb-2"><strong>Ubicación:</strong> <%= event.Ubicacion %></p>
            <p class="mb-2"><strong>Capacidad:</strong> <%= event.Capacidad_Maxima %> personas</p>
            <p class="mb-2"><strong>Tipo de Evento:</strong> <%= event.tipo %></p>
            <button class="btn btn-secondary btn-sm">Editar Evento</button>
            <button class="btn btn-danger btn-sm"  data-bs-toggle="modal" data-bs-target="#deleteEventModal">Eliminar Evento</button>
          </div>
        <% }); %>
      </div>
    <% } else { %>
      <p class="text-center text-muted">No hay eventos disponibles.</p>
    <% } %>
   
   <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#createEventModal">
    Añadir Evento
  </button>

  
  <div class="modal fade" id="createEventModal" tabindex="-1" aria-labelledby="createEventModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="createEventModalLabel">Crear Nuevo Evento</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          
          <form action="/viewEvents/create" method="POST" id="createEventForm" class="mb-4">
            <div class="row mb-3">
              <div class="col-md-6">
                <label for="title" class="form-label">Título</label>
                <input type="text" id="eventTitle" name="eventTitle" class="form-control" required>
              </div>
              <div class="col-md-6">
                <label for="type" class="form-label">Tipo de Evento</label>
                <select id="eventType" name="eventType" class="form-select" required>
                  <option value="seminario">Seminario</option>
                  <option value="taller">Taller</option>
                  <option value="conferencia">Conferencia</option>
                </select>
              </div>
            </div>
            <div class="row mb-3">
              <div class="col-md-6">
                <label for="date" class="form-label">Fecha</label>
                <input type="date" id="eventDate" name="eventDate" class="form-control" required>
              </div>
              <div class="col-md-6">
                <label for="time" class="form-label">Hora</label>
                <input type="time" id="eventTime" name="eventTime" class="form-control" required>
              </div>
            </div>
            <div class="row mb-3">
              <label for="duration" class="form-label">Duración</label>
                <input type="number" id="eventDuration" name="eventDuration" placeholder="En minutos" class="form-control" required>
            </div>
            <div class="row mb-3">
              <div class="col-md-6">
                <label for="location" class="form-label">Ubicación</label>
                <select id="eventLocation" name="eventLocation" class="form-select" required>
                  <% locations.forEach(location => { %>
                    <option value = "<% location.ID %>" ><%= location.Nombre %></option>
                  <% }); %>
                </select>
              </div>
              <div class="col-md-6">
                <label for="duration" class="form-label">Localización exacta</label>
                <input type="text" id="eventExact" name="eventExact" class="form-control" required>
              </div>
            </div>
            <div class="row mb-3">
              <label for="capacity" class="form-label">Capacidad Máxima</label>
              <input type="number" id="eventCapacity" name="eventCapacity" class="form-control" required>
            </div>
            <div class="row mb-3">
              <label for="description" class="form-label">Descripción</label>
              <textarea id="eventDescription" name="eventDescription" class="form-control" rows="3" required></textarea>
            </div>
            <button type="submit" class="btn btn-primary">Añadir Evento</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="deleteEventModal" tabindex="-1" aria-labelledby="deleteEventModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h6 class="modal-title" id="deleteEventModalLabel">¿Estás seguro de que deseas eliminar este evento?</h6>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <form id="deleteEventForm" method="POST" action="/viewEvents/delete">
            <input type="hidden" id="eventId" name="eventId" value="">
            <button type="submit" class="btn btn-danger">Eliminar Evento</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <%- include("footer") %>
</body>
</html>
